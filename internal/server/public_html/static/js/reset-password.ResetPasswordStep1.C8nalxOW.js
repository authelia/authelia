import{j as e,r,B as v,o as b,c as P,p as k,u as E,G as c,q as L,I as x}from"./index.aN1zXoDM.js";import{T as F,B as j}from"./constants.constants.BnGwwtlq.js";import{M as I}from"./layouts.Minimal.DGoaZIGi.js";import{i as S}from"./reset-password.ResetPassword.DlcibN-k.js";import{F as q,T as z}from"./mui.TextField.Cu4Ddjp5.js";import"./layouts.usePortalStyles.BJv0J0Xa.js";const B=function(a){const i=a;return e.jsx(r.Fragment,{children:a.render?e.jsx(F,{...i,children:e.jsx(v,{component:"span",children:a.children})}):a.children})},G=function(){const a=b(),[i,g]=r.useState(""),[w,d]=r.useState(!1),[l,u]=r.useState(!1),[m,f]=r.useState(!1),n=r.useRef(null),{createInfoNotification:R,createErrorNotification:o}=P(),h=k(),{t:s}=E();r.useEffect(()=>{if(n.current!==null)return clearTimeout(n.current)},[]);const T=r.useCallback(t=>{n.current&&clearTimeout(n.current),f(!0),o(s("You have made too many requests")),n.current=setTimeout(()=>{f(!1),n.current=null},t*1e3)},[o,s]),p=async()=>{if(d(!1),u(!0),i===""){d(!0),u(!1),o(s("Username is required"));return}try{const t=await S(i);t&&!t.limited?(R(s("An email has been sent to your address to complete the process")),h(x)):t&&t.limited?T(t.retryAfter):o(s("There was an issue initiating the password reset process"))}catch{o(s("There was an issue initiating the password reset process"))}u(!1)},y=()=>{p()},C=()=>{h(x)};return e.jsx(I,{title:s("Reset password"),id:"reset-password-step1-stage",children:e.jsx(q,{id:"form-reset-password-username",children:e.jsxs(c,{container:!0,sx:{marginY:a.spacing(2)},spacing:2,children:[e.jsx(c,{size:{xs:12},children:e.jsx(z,{id:"username-textfield",label:s("Username"),disabled:l,variant:"outlined",fullWidth:!0,error:w,value:i,onChange:t=>g(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),p())}})}),e.jsx(c,{size:{xs:6},children:e.jsx(B,{render:m,title:s("You have made too many requests"),children:e.jsx(j,{id:"reset-button",variant:"contained",disabled:l||m,color:"primary",fullWidth:!0,onClick:y,startIcon:l?e.jsx(L,{color:"inherit",size:20}):e.jsx(e.Fragment,{}),children:s("Reset")})})}),e.jsx(c,{size:{xs:6},children:e.jsx(j,{id:"cancel-button",variant:"contained",disabled:l,color:"primary",fullWidth:!0,onClick:C,children:s("Cancel")})})]})})})};export{G as default};

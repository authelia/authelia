import{u as b,m as C,bA as E,j as t,G as s,r as d,bB as P,az as L,bC as T,an as w,bD as N,bE as S,aA as k,B as p}from"./index.BAKKlMLi.js";import{b as z,u as R,S as W,A as $,T as j,P as I}from"./layouts.usePortalStyles.DPt9DQ4Y.js";import{h as U,E as v,n as B,a as A,C as F}from"./constants.constants.Dc-vougk.js";const M=function(e){const{t:n}=b(),{classes:r}=D(),i=E();return t.jsxs(s,{container:!0,size:{xs:12},alignItems:"center",justifyContent:"center",children:[t.jsx(s,{size:{xs:4},children:t.jsx(U,{href:atob(String.fromCharCode(...B)),target:"_blank",underline:"hover",className:r.links,children:n("Powered by {{authelia}}",{authelia:atob(String.fromCharCode(...v))})})}),i?t.jsxs(d.Fragment,{children:[t.jsx(A,{orientation:"vertical",flexItem:!0,variant:"middle"}),t.jsx(s,{size:{xs:4},children:t.jsx(z,{className:r.links})})]}):null]})},D=C()(e=>({links:{fontSize:"0.7rem",color:P[500]}}));function G(e){if(/^https?:\/\//i.test(e)||typeof globalThis>"u"||!("location"in globalThis)||!globalThis.location)return e;const n=T()??"",r=new URL(n.endsWith("/")?n:`${n}/`,globalThis.location.origin);return new URL(e,r).toString()}const H=({className:e})=>{const{definition:n}=L(),r=d.useRef(null),i=n.effect?.module??null;return d.useEffect(()=>{const l=r.current;if(!l)return;if(l.replaceChildren(),!i)return()=>{l.replaceChildren()};let f=!1,c;const a=()=>{if(typeof c=="function")try{c()}catch(o){console.error("An error occurred while cleaning up the portal template effect.",o)}c=void 0},x=o=>{c=o,f&&a()},m=G(i);return import(m).then(async o=>{if(f)return;const g=typeof o?.mount=="function"?o.mount:o?.default;if(typeof g!="function"){console.warn(`Portal template effect module '${m}' does not export a mount function.`);return}const u=g({container:l,definition:n});if(u instanceof Promise){const y=await u;x(y)}else x(u)}).catch(o=>{f||console.error(`Failed to load portal template effect module '${m}'.`,o)}),()=>{f=!0,a(),l.replaceChildren()}},[n,i]),t.jsx("div",{ref:r,className:e,"aria-hidden":"true","data-portal-effect-host":!0})};async function O(){try{return{...await w(N)}}catch(e){throw console.error("Failed to fetch locale information:",e),new Error("Failed to fetch locale information")}}const K=function(e){const{t:n}=b(),{locale:r,setLocale:i}=S(),[l,f]=d.useState([]),{definition:c}=L(),a=R(c),x=k()?t.jsx(p,{component:"img",src:"./static/media/logo.png",alt:"Logo",className:a.icon}):t.jsx(W,{className:a.icon}),m=h=>{i(h)},o=d.useCallback(async()=>{try{const h=await O();return f(h.languages),h}catch(h){console.error("could not get locale list:",h)}},[]);d.useEffect(()=>{o().then()},[o]),d.useEffect(()=>{document.title=n("Login - {{authelia}}",{authelia:atob(String.fromCharCode(...v))})},[n]);const g=`${a.rootContainer} ${a.typography} ${a.links} ${a.formElements} ${a.buttons} ${a.status}`.trim(),u=c.style.layout?.maxWidth,y=e.maxWidth!==void 0?e.maxWidth:u===void 0?"xs":u===!1?!1:u;return t.jsxs(p,{className:a.page,"data-portal-role":"page",children:[t.jsx(H,{className:a.effectHost}),t.jsx($,{userInfo:e.userInfo,onLocaleChange:m,localeList:l,localeCurrent:r}),t.jsxs(s,{id:e.id,className:a.root,container:!0,spacing:0,alignItems:"center",justifyContent:"center","data-portal-role":"root",children:[t.jsx(F,{maxWidth:y,className:g,"data-portal-role":"card",children:t.jsxs(s,{container:!0,className:a.typography,"data-portal-role":"content",children:[t.jsx(s,{size:{xs:12},children:x}),e.title?t.jsx(s,{size:{xs:12},maxWidth:"xs",children:t.jsx(j,{variant:"h5",value:e.title,tooltip:e.titleTooltip!==null?e.titleTooltip:void 0})}):null,e.subtitle?t.jsx(s,{size:{xs:12},children:t.jsx(j,{variant:"h6",value:e.subtitle,tooltip:e.subtitleTooltip!==null?e.subtitleTooltip:void 0})}):null,t.jsx(s,{size:{xs:12},className:a.body,children:e.children}),t.jsx(s,{size:{xs:12},className:a.links,children:t.jsx(M,{})})]})}),t.jsx(I,{})]})]})};export{K as L};

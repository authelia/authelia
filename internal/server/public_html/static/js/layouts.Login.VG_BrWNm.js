import{u as p,m as C,bA as E,j as t,G as n,r as u,bB as P,az as j,bC as T,an as N,bD as w,bE as S,aA as k,B as g}from"./index.BnjZL0N4.js";import{b as z,u as R,S as W,A as $,T as y,P as I}from"./layouts.usePortalStyles.DCcToFh4.js";import{h as U,E as b,n as B,a as A,C as F}from"./constants.constants.B5-HX_Wn.js";const M=function(e){const{t:o}=p(),{classes:s}=D(),i=E();return t.jsxs(n,{container:!0,size:{xs:12},alignItems:"center",justifyContent:"center",children:[t.jsx(n,{size:{xs:4},children:t.jsx(U,{href:atob(String.fromCharCode(...B)),target:"_blank",underline:"hover",className:s.links,children:o("Powered by {{authelia}}",{authelia:atob(String.fromCharCode(...b))})})}),i?t.jsxs(u.Fragment,{children:[t.jsx(A,{orientation:"vertical",flexItem:!0,variant:"middle"}),t.jsx(n,{size:{xs:4},children:t.jsx(z,{className:s.links})})]}):null]})},D=C()(e=>({links:{fontSize:"0.7rem",color:P[500]}}));function G(e){if(/^https?:\/\//i.test(e)||typeof globalThis>"u"||!("location"in globalThis)||!globalThis.location)return e;const o=T()??"",s=new URL(o.endsWith("/")?o:`${o}/`,globalThis.location.origin);return new URL(e,s).toString()}const H=({className:e})=>{const{definition:o}=j(),s=u.useRef(null),i=o.effect?.module??null;return u.useEffect(()=>{const l=s.current;if(!l)return;if(l.replaceChildren(),!i)return()=>{l.replaceChildren()};let h=!1,c;const a=G(i);return import(a).then(async r=>{if(h)return;const m=typeof r?.mount=="function"?r.mount:r?.default;if(typeof m!="function"){console.warn(`Portal template effect module '${a}' does not export a mount function.`);return}const d=m({container:l,definition:o});d instanceof Promise?c=await d:c=d}).catch(r=>{h||console.error(`Failed to load portal template effect module '${a}'.`,r)}),()=>{if(h=!0,typeof c=="function")try{c()}catch(r){console.error("An error occurred while cleaning up the portal template effect.",r)}l.replaceChildren()}},[o,i]),t.jsx("div",{ref:s,className:e,"aria-hidden":"true","data-portal-effect-host":!0})};async function O(){try{return{...await N(w)}}catch(e){throw console.error("Failed to fetch locale information:",e),new Error("Failed to fetch locale information")}}const K=function(e){const{t:o}=p(),{locale:s,setLocale:i}=S(),[l,h]=u.useState([]),{definition:c}=j(),a=R(c),r=k()?t.jsx(g,{component:"img",src:"./static/media/logo.png",alt:"Logo",className:a.icon}):t.jsx(W,{className:a.icon}),m=f=>{i(f)},d=u.useCallback(async()=>{try{const f=await O();return h(f.languages),f}catch(f){console.error("could not get locale list:",f)}},[]);u.useEffect(()=>{d().then()},[d]),u.useEffect(()=>{document.title=o("Login - {{authelia}}",{authelia:atob(String.fromCharCode(...b))})},[o]);const L=`${a.rootContainer} ${a.typography} ${a.links} ${a.formElements} ${a.buttons} ${a.status}`.trim(),x=c.style.layout?.maxWidth,v=e.maxWidth!==void 0?e.maxWidth:x===void 0?"xs":x===!1?!1:x;return t.jsxs(g,{className:a.page,"data-portal-role":"page",children:[t.jsx(H,{className:a.effectHost}),t.jsx($,{userInfo:e.userInfo,onLocaleChange:m,localeList:l,localeCurrent:s}),t.jsxs(n,{id:e.id,className:a.root,container:!0,spacing:0,alignItems:"center",justifyContent:"center","data-portal-role":"root",children:[t.jsx(F,{maxWidth:v,className:L,"data-portal-role":"card",children:t.jsxs(n,{container:!0,className:a.typography,"data-portal-role":"content",children:[t.jsx(n,{size:{xs:12},children:r}),e.title?t.jsx(n,{size:{xs:12},maxWidth:"xs",children:t.jsx(y,{variant:"h5",value:e.title,tooltip:e.titleTooltip!==null?e.titleTooltip:void 0})}):null,e.subtitle?t.jsx(n,{size:{xs:12},children:t.jsx(y,{variant:"h6",value:e.subtitle,tooltip:e.subtitleTooltip!==null?e.subtitleTooltip:void 0})}):null,t.jsx(n,{size:{xs:12},className:a.body,children:e.children}),t.jsx(n,{size:{xs:12},className:a.links,children:t.jsx(M,{})})]})}),t.jsx(I,{})]})]})};export{K as L};

import{Q as ut,aL as ot,a9 as it,a0 as q,aM as xt,aN as st,X as ct,ah as Et,aO as Nt,P as Ft,aP as jt,a8 as Lt,m as kt,j as C,B as Vt,r as Wt}from"./index.CEiXDjRd.js";import{S as Bt}from"./components.SuccessIcon.9My8fVrT.js";import{T as Mt}from"./components.TimerIcon.Cc0aXxNj.js";import{I as Ut}from"./portal.IconWithContext.CGRNMh1Q.js";function ne(a){switch(a){case 0:return"SHA1";case 1:return"SHA256";case 2:return"SHA512"}}function $(a){switch(a){case"SHA1":return 0;case"SHA256":return 1;case"SHA512":return 2}}function lt(a){return{algorithm:$(a.algorithm),created_at:new Date(a.created_at),digits:a.digits,issuer:a.issuer,last_used_at:a.last_used_at?new Date(a.last_used_at):void 0,period:a.period}}async function $t(){const a=await it(ot);return lt(a)}async function qt(){const a=await ut.get(ot,{validateStatus:function(p){return p<300||p===404}});return a===null||a.status===404||a.data.status==="KO"?null:lt(a.data.data)}async function re(){const a=await it(q);return{algorithm:$(a.algorithm),algorithms:a.algorithms.map(p=>$(p)),length:a.length,lengths:a.lengths,period:a.period,periods:a.periods}}async function ae(){return ut({method:"DELETE",url:st,validateStatus:xt})}function ue(){return ct($t)}function oe(){return ct(qt)}function ie(a,p,D,w,E,_){const N={flow:w,flowID:D,subflow:E,targetURL:p,token:`${a}`,userCode:_};return Et(st,N)}function se(a){const p={token:`${a}`};return Ft(q,p)}function ce(){return Nt(q)}var U={},at;function Ht(){return at||(at=1,(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var p=E(jt()),D=["placeholder","separator","isLastChild","ariaLabelOverride","shouldRender","inputStyle","focus","isDisabled","hasErrored","errorStyle","isSuccessed","successStyle","focusStyle","disabledStyle","shouldAutoFocus","isInputNum","index","value","className","isInputSecure","onSubmit"];function w(n){if(typeof WeakMap!="function")return null;var u=new WeakMap,i=new WeakMap;return(w=function(r){return r?i:u})(n)}function E(n,u){if(n&&n.__esModule)return n;if(n===null||T(n)!=="object"&&typeof n!="function")return{default:n};var i=w(u);if(i&&i.has(n))return i.get(n);var t={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in n)if(s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)){var c=r?Object.getOwnPropertyDescriptor(n,s):null;c&&(c.get||c.set)?Object.defineProperty(t,s,c):t[s]=n[s]}return t.default=n,i&&i.set(n,t),t}function _(){return _=Object.assign?Object.assign.bind():function(n){for(var u=1;u<arguments.length;u++){var i=arguments[u];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}return n},_.apply(this,arguments)}function N(n,u){if(n==null)return{};var i=pt(n,u),t,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],!(u.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function pt(n,u){if(n==null)return{};var i={},t=Object.keys(n),r,s;for(s=0;s<t.length;s++)r=t[s],!(u.indexOf(r)>=0)&&(i[r]=n[r]);return i}function H(n,u){if(!(n instanceof u))throw new TypeError("Cannot call a class as a function")}function ft(n,u){for(var i=0;i<u.length;i++){var t=u[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function K(n,u,i){return u&&ft(n.prototype,u),Object.defineProperty(n,"prototype",{writable:!1}),n}function z(n,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(u&&u.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),u&&F(n,u)}function F(n,u){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},F(n,u)}function G(n){var u=ht();return function(){var t=R(n),r;if(u){var s=R(this).constructor;r=Reflect.construct(t,arguments,s)}else r=t.apply(this,arguments);return dt(this,r)}}function dt(n,u){if(u&&(T(u)==="object"||typeof u=="function"))return u;if(u!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f(n)}function f(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function ht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R(n){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},R(n)}function d(n,u,i){return u in n?Object.defineProperty(n,u,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[u]=i,n}function T(n){"@babel/helpers - typeof";return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},T(n)}var vt=8,gt=37,yt=39,mt=46,It=32,Ot=13,S=function(u){return T(u)==="object"},bt=(function(n){z(i,n);var u=G(i);function i(t){var r;return H(this,i),r=u.call(this,t),d(f(r),"getClasses",function(){for(var s=arguments.length,c=new Array(s),e=0;e<s;e++)c[e]=arguments[e];return c.filter(function(o){return!S(o)&&o!==!1}).join(" ")}),d(f(r),"getType",function(){var s=r.props,c=s.isInputSecure,e=s.isInputNum;return c?"password":e?"tel":"text"}),d(f(r),"getAriaLabel",function(s,c){var e=r.props.ariaLabelOverride;return e||"".concat(s===0?"Please enter verification code. ":"").concat(c?"Digit":"Character"," ").concat(s+1)}),r.input=p.default.createRef(),r}return K(i,[{key:"componentDidMount",value:function(){var r=this.props,s=r.focus,c=r.shouldAutoFocus,e=this.input.current;e&&s&&c&&e.focus()}},{key:"componentDidUpdate",value:function(r){var s=this.props.focus,c=this.input.current;r.focus!==s&&c&&s&&(c.focus(),c.select())}},{key:"render",value:function(){var r=this.props,s=r.placeholder,c=r.separator,e=r.isLastChild;r.ariaLabelOverride;var o=r.shouldRender,l=r.inputStyle,g=r.focus,I=r.isDisabled,y=r.hasErrored,h=r.errorStyle,m=r.isSuccessed,b=r.successStyle,P=r.focusStyle,O=r.disabledStyle;r.shouldAutoFocus;var j=r.isInputNum,L=r.index,x=r.value,k=r.className;r.isInputSecure,r.onSubmit;var V=N(r,D);return p.default.createElement("div",{className:k,style:{display:"flex",alignItems:"center"}},p.default.createElement("input",_({"aria-label":this.getAriaLabel(L,j),style:Object.assign({width:"1em",textAlign:"center",padding:0},S(l)&&l,g&&S(P)&&P,I&&S(O)&&O,y&&!m&&S(h)&&h,m&&!y&&S(b)&&b),placeholder:s,className:this.getClasses(l,g&&P,I&&O,y&&!m&&h,m&&!y&&b),type:this.getType(),ref:this.input,disabled:I,value:x||""},V)),!e&&o&&c)}}]),i})(p.PureComponent),Q=(function(n){z(i,n);var u=G(i);function i(){var t;H(this,i);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return t=u.call.apply(u,[this].concat(s)),d(f(t),"state",{activeInput:0}),d(f(t),"getOtpValue",function(){return t.props.value?t.props.value.toString().split(""):[]}),d(f(t),"getPlaceholderValue",function(){var e=t.props,o=e.placeholder,l=e.numInputs;if(typeof o=="string"){if(o.length===l)return o;o.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}}),d(f(t),"handleOtpChange",function(e){var o=t.props.onChange,l=e.join("");o(l)}),d(f(t),"isInputValueValid",function(e){var o=t.props.isInputNum?!isNaN(parseInt(e,10)):typeof e=="string";return o&&e.trim().length===1}),d(f(t),"focusInput",function(e){var o=t.props.numInputs,l=Math.max(Math.min(o-1,e),0);t.setState({activeInput:l})}),d(f(t),"focusNextInput",function(){var e=t.state.activeInput;t.focusInput(e+1)}),d(f(t),"focusPrevInput",function(){var e=t.state.activeInput;t.focusInput(e-1)}),d(f(t),"changeCodeAtFocus",function(e){var o=t.state.activeInput,l=t.getOtpValue();l[o]=e[0],t.handleOtpChange(l)}),d(f(t),"handleOnPaste",function(e){e.preventDefault();var o=t.state.activeInput,l=t.props,g=l.numInputs,I=l.isDisabled;if(!I){for(var y=t.getOtpValue(),h=o,m=e.clipboardData.getData("text/plain"),b=t.props.isInputNum?m.replace(/\D/g,""):m,P=b.slice(0,g-o).split(""),O=0;O<g;++O)O>=o&&P.length>0&&(y[O]=P.shift(),h++);t.setState({activeInput:h},function(){t.focusInput(h),t.handleOtpChange(y)})}}),d(f(t),"handleOnChange",function(e){var o=e.target.value;t.isInputValueValid(o)&&t.changeCodeAtFocus(o)}),d(f(t),"handleOnKeyDown",function(e){e.keyCode===vt||e.key==="Backspace"?(e.preventDefault(),t.changeCodeAtFocus(""),t.focusInput(t.state.activeInput-1)):e.keyCode===mt||e.key==="Delete"?(e.preventDefault(),t.changeCodeAtFocus("")):e.keyCode===gt||e.key==="ArrowLeft"?(e.preventDefault(),t.focusPrevInput()):e.keyCode===yt||e.key==="ArrowRight"?(e.preventDefault(),t.focusNextInput()):e.keyCode===It||e.key===" "||e.key==="Spacebar"||e.key==="Space"?e.preventDefault():(e.keyCode===Ot||e.key==="Enter")&&t.props.onSubmit()}),d(f(t),"handleOnInput",function(e){var o=e.target.value;if(e.target.value){if(e.target.value&&e.target.value.length>1){e.preventDefault();for(var l=t.props.numInputs,g=t.state.activeInput,I=t.getOtpValue(),y=e.target.value.slice(0,l-g).split(""),h=0;h<l;++h)h>=g&&y.length>0&&(I[h]=y.shift());t.handleOtpChange(I),t.focusInput(t.props.numInputs)}else if(o&&o.trim().length>1)e.clipboardData={getData:function(){return o.trim()}},t.handleOnPaste(e);else if(t.isInputValueValid(e.target.value))t.focusNextInput();else if(!t.props.isInputNum){var m=e.nativeEvent;m.data===null&&m.inputType==="deleteContentBackward"&&(e.preventDefault(),t.changeCodeAtFocus(""),t.focusPrevInput())}}}),d(f(t),"renderInputs",function(){for(var e=t.state.activeInput,o=t.props,l=o.id,g=o.autoComplete,I=o.numInputs,y=o.inputStyle,h=o.focusStyle,m=o.separator,b=o.separateAfter,P=b===void 0?1:b,O=o.isDisabled,j=o.disabledStyle,L=o.hasErrored,x=o.errorStyle,k=o.isSuccessed,V=o.successStyle,Pt=o.shouldAutoFocus,Ct=o.isInputNum,_t=o.isInputSecure,Dt=o.className,A=o.inputProps,Tt=o.onSubmit,X=[],J=t.getOtpValue(),Y=t.getPlaceholderValue(),Z=t.props["data-cy"],tt=t.props["data-testid"],et=t.props["custom-test-attr"],nt=t.props["custom-test-id"],At=function(v){var B=void 0;(v+1)%parseInt(P)===0?B=!0:B=!1;var rt={};et&&(rt[et]=nt&&"".concat(nt,"-").concat(v));var M={};A&&(Array.isArray(A)?A[v]&&(M=A[v]):M=A),X.push(p.default.createElement(bt,_({id:l&&"".concat(l,"-").concat(v),autoComplete:g??"off",placeholder:Y&&Y[v],key:v,index:v,focus:e===v,value:J&&J[v],onChange:t.handleOnChange,onKeyDown:t.handleOnKeyDown,onInput:t.handleOnInput,onPaste:t.handleOnPaste,onFocus:function(Rt){t.setState({activeInput:v}),Rt.target.select()},onBlur:function(){return t.setState({activeInput:-1})},separator:m,inputStyle:y,focusStyle:h,isLastChild:v===I-1,isDisabled:O,disabledStyle:j,hasErrored:L,errorStyle:x,isSuccessed:k,successStyle:V,shouldAutoFocus:Pt,isInputNum:Ct,isInputSecure:_t,className:Dt,"data-cy":Z&&"".concat(Z,"-").concat(v),"data-testid":tt&&"".concat(tt,"-").concat(v),shouldRender:B,onSubmit:Tt},M,rt)))},W=0;W<I;W++)At(W);return X}),t}return K(i,[{key:"componentDidUpdate",value:function(){var r=this.props.value,s=this.state.activeInput;r==""&&s>0&&this.setState({activeInput:0})}},{key:"render",value:function(){var r=this.props.containerStyle;return p.default.createElement("div",{style:Object.assign({display:"flex"},S(r)&&r),className:S(r)?"":r},this.renderInputs())}}]),i})(p.Component);d(Q,"defaultProps",{numInputs:4,onChange:function(u){return console.log(u)},isDisabled:!1,shouldAutoFocus:!1,value:"",isInputSecure:!1,onSubmit:function(u){return console.log(u)}});var St=Q;a.default=St})(U)),U}var Kt=Ht();const zt=Lt(Kt);var Gt=(a=>(a[a.Idle=1]="Idle",a[a.InProgress=2]="InProgress",a[a.Success=3]="Success",a[a.Failure=4]="Failure",a[a.RateLimited=5]="RateLimited",a))(Gt||{});const le=function(a){const{classes:p,cx:D}=Xt();return C.jsx(Ut,{icon:C.jsx(Qt,{state:a.state,period:a.period}),children:C.jsx(Vt,{component:"span",className:p.otpInput,id:"otp-input",children:C.jsx(zt,{shouldAutoFocus:!0,onChange:a.onChange,value:a.passcode,numInputs:a.digits,isDisabled:a.state===2||a.state===3||a.state===5,isInputNum:!0,hasErrored:a.state===4,autoComplete:"one-time-code",inputStyle:D(p.otpDigitInput,a.state===4?p.inputError:"")})})})};function Qt(a){return C.jsx(Wt.Fragment,{children:a.state===3?C.jsx(Bt,{}):C.jsx(Mt,{backgroundColor:"#000",color:"#FFFFFF",width:64,height:64,period:a.period})})}const Xt=kt()(a=>({inputError:{border:"1px solid rgba(255, 2, 2, 0.95)"},otpDigitInput:{border:"1px solid rgba(0,0,0,0.3)",borderRadius:"5px",boxSizing:"content-box",fontSize:"1rem",marginLeft:a.spacing(.5),marginRight:a.spacing(.5),padding:a.spacing()+" !important"},otpInput:{display:"inline-block",marginTop:a.spacing(2)},register:{marginTop:a.spacing()},timeProgress:{}}));export{le as O,Gt as S,ue as a,ie as b,se as c,ae as d,re as g,ce as s,ne as t,oe as u};

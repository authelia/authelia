import{j as e,r,B as v,o as b,c as P,p as k,u as E,G as c,q as L,I as x}from"./index.J4YSomth.js";import{T as F,B as j}from"./constants.constants.BvDkw1BZ.js";import{M as I}from"./layouts.Minimal.B5R3q08x.js";import{i as S}from"./reset-password.ResetPassword.jbPnUGnP.js";import{F as q,T as z}from"./mui.TextField.oVnBvIhZ.js";import"./components.TypographyWithTooltip.DDFBjLT9.js";const B=function(a){const i=a;return e.jsx(r.Fragment,{children:a.render?e.jsx(F,{...i,children:e.jsx(v,{component:"span",children:a.children})}):a.children})},G=function(){const a=b(),[i,g]=r.useState(""),[w,d]=r.useState(!1),[l,u]=r.useState(!1),[m,f]=r.useState(!1),n=r.useRef(null),{createErrorNotification:o,createInfoNotification:R}=P(),h=k(),{t}=E();r.useEffect(()=>{if(n.current!==null)return clearTimeout(n.current)},[]);const T=r.useCallback(s=>{n.current&&clearTimeout(n.current),f(!0),o(t("You have made too many requests")),n.current=setTimeout(()=>{f(!1),n.current=null},s*1e3)},[o,t]),p=async()=>{if(d(!1),u(!0),i===""){d(!0),u(!1),o(t("Username is required"));return}try{const s=await S(i);s?.limited===!1?(R(t("An email has been sent to your address to complete the process")),h(x)):s?.limited?T(s.retryAfter):o(t("There was an issue initiating the password reset process"))}catch{o(t("There was an issue initiating the password reset process"))}u(!1)},y=()=>{p()},C=()=>{h(x)};return e.jsx(I,{title:t("Reset password"),id:"reset-password-step1-stage",children:e.jsx(q,{id:"form-reset-password-username",children:e.jsxs(c,{container:!0,sx:{marginY:a.spacing(2)},spacing:2,children:[e.jsx(c,{size:{xs:12},children:e.jsx(z,{id:"username-textfield",label:t("Username"),disabled:l,variant:"outlined",fullWidth:!0,error:w,value:i,onChange:s=>g(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),p())}})}),e.jsx(c,{size:{xs:6},children:e.jsx(B,{render:m,title:t("You have made too many requests"),children:e.jsx(j,{id:"reset-button",variant:"contained",disabled:l||m,color:"primary",fullWidth:!0,onClick:y,startIcon:l?e.jsx(L,{color:"inherit",size:20}):e.jsx(e.Fragment,{}),children:t("Reset")})})}),e.jsx(c,{size:{xs:6},children:e.jsx(j,{id:"cancel-button",variant:"contained",disabled:l,color:"primary",fullWidth:!0,onClick:C,children:t("Cancel")})})]})})})};export{G as default};

import{u as p,m as C,bA as P,j as e,G as o,r as u,bB as E,az as j,bC as w,an as N,bD as S,bE as k,aA as z,B as g}from"./index.Ceu454BR.js";import{b as T,u as R,S as W,A as $,T as y,P as I}from"./layouts.usePortalStyles.B0WqWIDg.js";import{h as U,E as L,n as B,a as A,C as F}from"./constants.constants.DWj29GYq.js";const M=function(t){const{t:n}=p(),{classes:s}=D(),i=P();return e.jsxs(o,{container:!0,size:{xs:12},alignItems:"center",justifyContent:"center",children:[e.jsx(o,{size:{xs:4},children:e.jsx(U,{href:atob(String.fromCharCode(...B)),target:"_blank",underline:"hover",className:s.links,children:n("Powered by {{authelia}}",{authelia:atob(String.fromCharCode(...L))})})}),i?e.jsxs(u.Fragment,{children:[e.jsx(A,{orientation:"vertical",flexItem:!0,variant:"middle"}),e.jsx(o,{size:{xs:4},children:e.jsx(T,{className:s.links})})]}):null]})},D=C()(t=>({links:{fontSize:"0.7rem",color:E[500]}}));function G(t){if(/^https?:\/\//i.test(t))return t;const n=w()??"",s=new URL(n.endsWith("/")?n:`${n}/`,window.location.origin);return new URL(t,s).toString()}const H=({className:t})=>{const{definition:n}=j(),s=u.useRef(null),i=n.effect?.module??null;return u.useEffect(()=>{const l=s.current;if(!l)return;if(l.replaceChildren(),!i)return()=>{l.replaceChildren()};let h=!1,c;const a=G(i);return import(a).then(async r=>{if(h)return;const m=typeof r?.mount=="function"?r.mount:r?.default;if(typeof m!="function"){console.warn(`Portal template effect module '${a}' does not export a mount function.`);return}const d=m({container:l,definition:n});d instanceof Promise?c=await d:c=d}).catch(r=>{h||console.error(`Failed to load portal template effect module '${a}'.`,r)}),()=>{if(h=!0,typeof c=="function")try{c()}catch(r){console.error("An error occurred while cleaning up the portal template effect.",r)}l.replaceChildren()}},[n,i]),e.jsx("div",{ref:s,className:t,"aria-hidden":"true","data-portal-effect-host":!0})};async function O(){try{return{...await N(S)}}catch(t){throw console.error("Failed to fetch locale information:",t),new Error("Failed to fetch locale information")}}const K=function(t){const{t:n}=p(),{locale:s,setLocale:i}=k(),[l,h]=u.useState([]),{definition:c}=j(),a=R(c),r=z()?e.jsx(g,{component:"img",src:"./static/media/logo.png",alt:"Logo",className:a.icon}):e.jsx(W,{className:a.icon}),m=f=>{i(f)},d=u.useCallback(async()=>{try{const f=await O();return h(f.languages),f}catch(f){console.error("could not get locale list:",f)}},[]);u.useEffect(()=>{d().then()},[d]),u.useEffect(()=>{document.title=n("Login - {{authelia}}",{authelia:atob(String.fromCharCode(...L))})},[n]);const b=`${a.rootContainer} ${a.typography} ${a.links} ${a.formElements} ${a.buttons} ${a.status}`.trim(),x=c.style.layout?.maxWidth,v=t.maxWidth!==void 0?t.maxWidth:x===void 0?"xs":x===!1?!1:x;return e.jsxs(g,{className:a.page,"data-portal-role":"page",children:[e.jsx(H,{className:a.effectHost}),e.jsx($,{userInfo:t.userInfo,onLocaleChange:m,localeList:l,localeCurrent:s}),e.jsxs(o,{id:t.id,className:a.root,container:!0,spacing:0,alignItems:"center",justifyContent:"center","data-portal-role":"root",children:[e.jsx(F,{maxWidth:v,className:b,"data-portal-role":"card",children:e.jsxs(o,{container:!0,className:a.typography,"data-portal-role":"content",children:[e.jsx(o,{size:{xs:12},children:r}),t.title?e.jsx(o,{size:{xs:12},maxWidth:"xs",children:e.jsx(y,{variant:"h5",value:t.title,tooltip:t.titleTooltip!==null?t.titleTooltip:void 0})}):null,t.subtitle?e.jsx(o,{size:{xs:12},children:e.jsx(y,{variant:"h6",value:t.subtitle,tooltip:t.subtitleTooltip!==null?t.subtitleTooltip:void 0})}):null,e.jsx(o,{size:{xs:12},className:a.body,children:t.children}),e.jsx(o,{size:{xs:12},className:a.links,children:e.jsx(M,{})})]})}),e.jsx(I,{})]})]})};export{K as L};

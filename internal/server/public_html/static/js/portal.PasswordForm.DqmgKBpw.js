import{c as I,u as D,g as E,h as A,r as t,j as e,G as l}from"./index.CEiXDjRd.js";import{I as F,V as R,a as K,A as U,b as z}from"./mui.VisibilityOff.CN4DP5jp.js";import{v as M,I as B,B as V,C as W}from"./constants.constants.RkJrtp09.js";import{a as G,I as N}from"./services.Password.Dab8ZkAz.js";import{F as q,T as O}from"./mui.TextField.o9feOhtZ.js";const Z=function(d){const{createErrorNotification:f}=I(),{t:o}=D(["portal","settings"]),p=E(A),{flow:w,id:h,subflow:m}=M(),[c,x]=t.useState(!1),[r,g]=t.useState(""),[b,y]=t.useState(!1),[T,C]=t.useState(!1),[v,P]=t.useState(!1),[j,a]=t.useState(!1),i=t.useRef(null),n=t.useCallback(()=>{i.current!==null&&i.current.focus()},[i]);t.useEffect(()=>{const s=setTimeout(()=>n(),10);return()=>clearTimeout(s)},[n]);const u=t.useCallback(async()=>{if(r===""){P(!0);return}x(!0);try{const s=await G(r,p,h,w,m);d.onAuthenticationSuccess(s?s.redirect:void 0)}catch(s){console.error(s),f(o("Incorrect password")),g(""),x(!1),n()}},[f,n,r,d,p,o,h,w,m]),L=t.useCallback(s=>{s.key==="Enter"&&(r.length||n(),u().catch(console.error),s.preventDefault())},[n,u,r.length]),S=t.useCallback(s=>{if(r.length<=1&&(y(!1),C(!1),r.length===0))return;const k=N(s);k!==null&&(k?y(!0):C(!0))},[r.length]);return e.jsx(q,{id:"form-password",children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{size:{xs:12},children:e.jsx(O,{inputRef:i,id:"password-textfield",label:o("Password"),variant:"outlined",required:!0,fullWidth:!0,disabled:c,value:r,error:v,onChange:s=>g(s.target.value),onFocus:()=>P(!1),type:j?"text":"password",autoComplete:"current-password",onKeyDown:L,onKeyUp:S,slotProps:{input:{endAdornment:e.jsx(F,{position:"end",children:e.jsx(B,{"aria-label":o("Toggle password visibility"),edge:"end",size:"large",onMouseDown:()=>a(!0),onMouseUp:()=>a(!1),onMouseLeave:()=>a(!1),onTouchStart:()=>a(!0),onTouchEnd:()=>a(!1),onTouchCancel:()=>a(!1),onKeyDown:s=>{s.key===" "&&(a(!0),s.preventDefault())},onKeyUp:s=>{s.key===" "&&(a(!1),s.preventDefault())},children:j?e.jsx(R,{}):e.jsx(K,{})})})}}})}),b?e.jsx(l,{size:{xs:12},marginX:2,children:e.jsxs(U,{severity:"warning",children:[e.jsx(z,{children:o("Warning")}),o(T?"The password was partially entered with Caps Lock":"The password was entered with Caps Lock")]})}):null,e.jsx(l,{size:{xs:12},children:e.jsx(V,{id:"sign-in-button",variant:"contained",color:"primary",fullWidth:!0,endIcon:c?e.jsx(W,{size:20}):null,disabled:c,onClick:u,children:o("Authenticate",{ns:"settings"})})})]})})};export{Z as P};

import{c as I,u as D,g as E,h as A,r as t,j as e,G as l,t as F,ak as R,q as K}from"./index.Ceu454BR.js";import{I as U,V as z,a as M,A as B}from"./mui.VisibilityOff.Bw3rHpwp.js";import{j as V,B as W}from"./constants.constants.DWj29GYq.js";import{a as q,I as G}from"./services.Password.CPpzc6SF.js";import{F as N,T as O}from"./mui.TextField.BrgfK03L.js";const Z=function(d){const{createErrorNotification:f}=I(),{t:o}=D(["portal","settings"]),p=E(A),{id:w,flow:h,subflow:m}=V(),[c,x]=t.useState(!1),[r,g]=t.useState(""),[b,y]=t.useState(!1),[T,j]=t.useState(!1),[L,C]=t.useState(!1),[P,a]=t.useState(!1),i=t.useRef(null),n=t.useCallback(()=>{i.current!==null&&i.current.focus()},[i]);t.useEffect(()=>{const s=setTimeout(()=>n(),10);return()=>clearTimeout(s)},[n]);const u=t.useCallback(async()=>{if(r===""){C(!0);return}x(!0);try{const s=await q(r,p,w,h,m);d.onAuthenticationSuccess(s?s.redirect:void 0)}catch(s){console.error(s),f(o("Incorrect password")),g(""),x(!1),n()}},[f,n,r,d,p,o,w,h,m]),S=t.useCallback(s=>{s.key==="Enter"&&(r.length||n(),u().catch(console.error),s.preventDefault())},[n,u,r.length]),v=t.useCallback(s=>{if(r.length<=1&&(y(!1),j(!1),r.length===0))return;const k=G(s);k!==null&&(k?y(!0):j(!0))},[r.length]);return e.jsx(N,{id:"form-password",children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{size:{xs:12},children:e.jsx(O,{inputRef:i,id:"password-textfield",label:o("Password"),variant:"outlined",required:!0,fullWidth:!0,disabled:c,value:r,error:L,onChange:s=>g(s.target.value),onFocus:()=>C(!1),type:P?"text":"password",autoComplete:"current-password",onKeyDown:S,onKeyUp:v,slotProps:{input:{endAdornment:e.jsx(U,{position:"end",children:e.jsx(F,{"aria-label":o("Toggle password visibility"),edge:"end",size:"large",onMouseDown:()=>a(!0),onMouseUp:()=>a(!1),onMouseLeave:()=>a(!1),onTouchStart:()=>a(!0),onTouchEnd:()=>a(!1),onTouchCancel:()=>a(!1),onKeyDown:s=>{s.key===" "&&(a(!0),s.preventDefault())},onKeyUp:s=>{s.key===" "&&(a(!1),s.preventDefault())},children:P?e.jsx(z,{}):e.jsx(M,{})})})}}})}),b?e.jsx(l,{size:{xs:12},marginX:2,children:e.jsxs(R,{severity:"warning",children:[e.jsx(B,{children:o("Warning")}),o(T?"The password was partially entered with Caps Lock":"The password was entered with Caps Lock")]})}):null,e.jsx(l,{size:{xs:12},children:e.jsx(W,{id:"sign-in-button",variant:"contained",color:"primary",fullWidth:!0,endIcon:c?e.jsx(K,{size:20}):null,disabled:c,onClick:u,children:o("Authenticate",{ns:"settings"})})})]})})};export{Z as P};
